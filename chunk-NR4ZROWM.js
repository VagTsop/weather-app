import{$a as D,Bb as K,Cb as W,Db as j,Eb as z,Kb as A,Lb as $,Mb as U,Na as m,Nb as G,Oa as i,Ob as L,Pa as n,Pb as R,Q as h,Qa as y,Qb as J,Rb as Q,Ua as w,V as I,Va as k,W as O,Wa as M,Xa as x,Za as _,_a as T,a as v,aa as b,ab as r,b as C,bb as u,cb as f,eb as F,fb as N,gb as V,ib as S,jb as E,kb as q,mb as B,oa as o,ob as H,xa as P,za as d}from"./chunk-TDZXY2GT.js";function Y(a,t){if(a&1&&(i(0,"span"),r(1),n()),a&2){let e=_().$implicit;o(),f(", ",e.country)}}function Z(a,t){if(a&1){let e=M();i(0,"div",13),x("click",function(){let s=I(e).$implicit,p=_(2);return O(p.pick(s))}),r(1),d(2,Y,2,1,"span",14),n()}if(a&2){let e=t.$implicit;o(),f(" ",e.name),o(),m("ngIf",e.country)}}function ee(a,t){if(a&1&&(i(0,"div",10)(1,"div",11),d(2,Z,3,2,"div",12),n()()),a&2){let e=_();o(2),m("ngForOf",e.results())}}function te(a,t){a&1&&(i(0,"span"),r(1,"\xB0"),n())}function ne(a,t){if(a&1&&y(0,"app-weather-icon",30),a&2){let e=_(2).$implicit;m("code",e.code)}}function ie(a,t){a&1&&(i(0,"span"),r(1,"\xB0"),n())}function re(a,t){a&1&&(i(0,"span"),r(1,"%"),n())}function ae(a,t){a&1&&(i(0,"span"),r(1,"km"),n())}function oe(a,t){a&1&&(i(0,"span"),r(1,"hPa"),n())}function pe(a,t){if(a&1&&(w(0),i(1,"div",19)(2,"div",20)(3,"div",21),r(4),S(5,"date"),n(),i(6,"div",22),r(7),d(8,te,2,0,"span",14),n()(),d(9,ne,1,1,"app-weather-icon",23),n(),i(10,"div",24)(11,"div")(12,"span"),r(13,"Feels like"),n(),i(14,"b"),r(15),d(16,ie,2,0,"span",14),n()(),i(17,"div")(18,"span"),r(19,"Humidity"),n(),i(20,"b"),r(21),d(22,re,2,0,"span",14),n()(),i(23,"div")(24,"span"),r(25,"Wind"),n(),i(26,"b"),r(27),n()(),i(28,"div")(29,"span"),r(30,"Precip"),n(),i(31,"b"),r(32),n()(),i(33,"div")(34,"span"),r(35,"UV"),n(),i(36,"b"),r(37),n()(),i(38,"div")(39,"span"),r(40,"Visibility"),n(),i(41,"b"),r(42),d(43,ae,2,0,"span",14),n()(),i(44,"div")(45,"span"),r(46,"Pressure"),n(),i(47,"b"),r(48),d(49,oe,2,0,"span",14),n()()(),i(50,"div",25)(51,"div",26)(52,"span"),r(53,"Sunrise"),n(),i(54,"div",27),y(55,"span",28),n(),i(56,"span"),r(57),S(58,"date"),n()(),i(59,"div",26)(60,"span"),r(61,"Sunset"),n(),i(62,"div",29),y(63,"span",28),n(),i(64,"span"),r(65),S(66,"date"),n()()(),k()),a&2){let e=_().$implicit;o(),D("loading",e.loading),o(3),u(E(5,19,e.timeISO,"EEEE, MMM d")),o(3),f(" ",e.temp??"\u2014"),o(),m("ngIf",e.temp!==void 0),o(),m("ngIf",e.code!==void 0),o(6),u(e.apparent??"\u2014"),o(),m("ngIf",e.apparent!==void 0),o(5),u(e.humidity??"\u2014"),o(),m("ngIf",e.humidity!==void 0),o(5),u(e.wind??"\u2014"),o(5),u(e.precip??"\u2014"),o(5),u(e.uv??"\u2014"),o(5),f("",e.visibilityKm??"\u2014"," "),o(),m("ngIf",e.visibilityKm!==null),o(5),f("",e.pressureHpa??"\u2014"," "),o(),m("ngIf",e.pressureHpa!==null),o(8),u(E(58,22,e.sunriseISO,"h:mm a")),o(8),u(E(66,25,e.sunsetISO,"h:mm a"))}}function se(a,t){a&1&&(i(0,"div",31),r(1,"API error"),n())}function le(a,t){if(a&1){let e=M();i(0,"div",15)(1,"div",16)(2,"b"),r(3),n(),i(4,"button",17),x("click",function(){let s=I(e).index,p=_();return O(p.remove(s))}),r(5,"\xD7"),n()(),d(6,pe,67,28,"ng-container",18)(7,se,2,0,"ng-template",null,0,q),n()}if(a&2){let e=t.$implicit,l=T(8);o(3),u(e.place.name),o(3),m("ngIf",!e.error)("ngIfElse",l)}}var X=class a{geo=h(J);api=h(A);units=h($);q="";searching=b(!1);results=b([]);cards=b([]);constructor(){H(()=>{let t=this.units.units();B(()=>{this.cards().forEach((l,s)=>this.load(s,l.place))})})}search(){let t=this.q.trim();t&&(this.searching.set(!0),this.geo.search(t).subscribe({next:e=>this.results.set(e),error:()=>this.results.set([]),complete:()=>this.searching.set(!1)}))}pick(t){this.results.set([]),this.q=t.name,this.add(t)}add(t){if(this.cards().some(s=>s.place.latitude===t.latitude&&s.place.longitude===t.longitude))return;this.cards.update(s=>[...s,{place:t,loading:!0}]);let l=this.cards().length-1;this.load(l,t)}remove(t){this.cards.update(e=>e.filter((l,s)=>s!==t))}load(t,e){if(!this.cards()[t])return;this.cards.update(p=>{let c=[...p];return c[t]?(c[t]=C(v({},c[t]),{loading:!0,error:void 0}),c):p});let s=this.units.units();this.api.get(e.latitude,e.longitude,{system:s.system,temp:s.temp,wind:s.wind,precip:s.precip}).subscribe({next:p=>{this.cards.update(c=>{let g=[...c];return g[t]?(g[t]=C(v({},g[t]),{loading:!1,timeISO:p.current.timeISO,temp:p.current.temp,apparent:p.current.apparent,humidity:p.current.humidity,wind:p.current.wind,precip:p.current.precip,code:p.current.code,uv:p.uv??g[t].uv??null,visibilityKm:p.visibilityKm??g[t].visibilityKm??null,pressureHpa:p.pressureHpa??g[t].pressureHpa??null,sunriseISO:p.sunriseISO??g[t].sunriseISO??null,sunsetISO:p.sunsetISO??g[t].sunsetISO??null}),g):c})},error:()=>{this.cards.update(p=>{let c=[...p];return c[t]?(c[t]=C(v({},c[t]),{loading:!1,error:"API error"}),c):p})}})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=P({type:a,selectors:[["app-compare"]],decls:11,vars:3,consts:[["err",""],[1,"page"],[1,"title"],[1,"compare-bar"],[1,"search-input"],["placeholder","Search for a city...",3,"ngModelChange","keyup.enter","ngModel"],[1,"search-btn",3,"click"],["class","results",4,"ngIf"],[1,"grid"],["class","panel card",4,"ngFor","ngForOf"],[1,"results"],[1,"card","list"],["class","item",3,"click",4,"ngFor","ngForOf"],[1,"item",3,"click"],[4,"ngIf"],[1,"panel","card"],[1,"head"],[1,"x",3,"click"],[4,"ngIf","ngIfElse"],[1,"hero","small"],[1,"left"],[1,"date"],[1,"temp"],[3,"code",4,"ngIf"],[1,"kpis"],[1,"sun"],[1,"sun-row"],[1,"bar"],[1,"dot"],[1,"bar","dusk"],[3,"code"],[1,"error"]],template:function(e,l){e&1&&(i(0,"section",1)(1,"h1",2),r(2,"Compare locations"),n(),i(3,"div",3)(4,"div",4)(5,"input",5),V("ngModelChange",function(p){return N(l.q,p)||(l.q=p),p}),x("keyup.enter",function(){return l.search()}),n(),i(6,"button",6),x("click",function(){return l.search()}),r(7,"Add"),n()(),d(8,ee,3,1,"div",7),n(),i(9,"div",8),d(10,le,9,3,"div",9),n()()),e&2&&(o(5),F("ngModel",l.q),o(3),m("ngIf",l.results().length),o(2),m("ngForOf",l.cards()))},dependencies:[z,K,W,R,U,G,L,Q,j],styles:[".page[_ngcontent-%COMP%]{max-width:1120px;margin:24px auto;padding:0 16px}.title[_ngcontent-%COMP%]{font-family:Bricolage Grotesque,sans-serif;font-size:34px;margin:8px 0 16px;text-align:center}.compare-bar[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}.search-input[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:center}.search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:min(640px,100%);padding:12px 14px;background:#2e314a;color:#fff;border:0;border-radius:12px}.search-btn[_ngcontent-%COMP%]{background:#5c6cff;border-radius:12px;padding:10px 16px;color:#fff;border:0}.results[_ngcontent-%COMP%]{display:flex;justify-content:center}.list[_ngcontent-%COMP%]{width:min(640px,100%);padding:0;margin-top:6px}.item[_ngcontent-%COMP%]{padding:10px 14px;cursor:pointer}.item[_ngcontent-%COMP%]:hover{background:#2b2e48}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px}.card[_ngcontent-%COMP%]{padding:14px}.head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.head[_ngcontent-%COMP%]   .x[_ngcontent-%COMP%]{background:#2b2e48;border-radius:8px;padding:4px 8px}.hero.small[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:#2b2e48;border-radius:12px;padding:12px}.hero.small.loading[_ngcontent-%COMP%]{opacity:.6}.temp[_ngcontent-%COMP%]{font-size:40px;font-weight:800}.kpis[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px}.kpis[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--muted);font-size:12px}.sun[_ngcontent-%COMP%]{margin-top:12px;display:flex;flex-direction:column;gap:6px}.sun-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;gap:8px;align-items:center}.bar[_ngcontent-%COMP%]{height:6px;background:#3a3f62;border-radius:999px;position:relative}.dot[_ngcontent-%COMP%]{position:absolute;left:12%;top:-3px;width:12px;height:12px;border-radius:50%;background:#ffd76a;box-shadow:0 0 10px #ffd76a}.bar.dusk[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{left:78%}.error[_ngcontent-%COMP%]{background:#2b2e48;border-radius:10px;padding:10px;text-align:center}"]})};export{X as CompareComponent};
